<div class="project-search-bar">
    <form ng-submit="vm.doSearch(vm.searchTerm)">
        <div class="content" layout="row" layout-align="end" >
            <div flex layout="row">

                <md-autocomplete flex md-selected-item="vm.selectedTag"
                                 placeholder="{{ vm.getPlaceholderText() }}"
                                 md-search-text="vm.searchTerm"
                                 md-search-text-change="vm.searchTextChanged(vm.searchTerm)"
                                 md-selected-item-change="vm.addTagFilter(tag)"
                                 md-items="tag in vm.getTagMatches(vm.searchTerm)"
                                 md-no-cache="true"
                                 md-item-text="tag.name">

                    <md-item-template>
                        <div class="autocomplete-template" layout="row" layout-align="start center">
                            <span class="family-name">{{ tag.tagFamily.name }}</span>
                            <tag source="tag" show-close="false"></tag>
                        </div>
                    </md-item-template>

                </md-autocomplete>

                <div layout="row" layout-align="centre centre">
                    <md-checkbox md-no-ink aria-label="Global Search" ng-model="vm.searchAll" class="global-checkbox">
                        Global
                    </md-checkbox>
                </div>
            </div>
        </div>

        <div class="tag-filters">
            <span ng-show="0 < vm.selectedTags.length">Tag filters:</span>
            <tag ng-repeat="tag in vm.selectedTags track by tag.uuid"
                 show-close="true"
                 source="tag"
                 on-close="vm.removeTagFilter(tag)"></tag>
        </div>
    </form>
</div>